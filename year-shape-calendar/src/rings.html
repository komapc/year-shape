<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Multi-Ring Calendar - YearWheel</title>
    <!-- Tailwind CSS for header styling -->
    <link rel="stylesheet" href="/style.css" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        color: white;
        overflow-x: hidden;
        max-width: 100vw;
      }

      h1 {
        margin-bottom: 10px;
        font-size: 2rem;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .subtitle {
        margin-bottom: 20px;
        opacity: 0.9;
        font-size: 0.9rem;
      }

      .controls {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        width: 600px;
        max-width: 90vw;
      }

      .control-group {
        margin-bottom: 15px;
      }

      .control-group:last-child {
        margin-bottom: 0;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        font-size: 0.9rem;
      }

      input[type="range"] {
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: rgba(255, 255, 255, 0.2);
        outline: none;
        -webkit-appearance: none;
      }

      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: white;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      input[type="range"]::-moz-range-thumb {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: white;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        border: none;
      }

      .value-display {
        display: inline-block;
        background: rgba(255, 255, 255, 0.2);
        padding: 3px 10px;
        border-radius: 5px;
        font-weight: 600;
        font-size: 0.85rem;
        margin-left: 10px;
      }

      .main-content {
        display: flex;
        gap: 20px;
        align-items: flex-start;
        max-width: 1200px;
      }

      #canvas-container {
        position: relative;
        width: 700px;
        height: 700px;
        max-width: 90vw;
        max-height: 90vw;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        overflow: hidden;
        flex-shrink: 0;
        box-sizing: border-box;
      }

      .layer-controls {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        min-width: 250px;
        max-width: 300px;
      }

      .layer-controls h3 {
        margin: 0 0 15px 0;
        font-size: 1.1rem;
        font-weight: 600;
      }

      .layer-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .layer-item {
        background: rgba(255, 255, 255, 0.15);
        padding: 12px;
        margin-bottom: 8px;
        border-radius: 8px;
        cursor: move;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .layer-item:hover {
        background: rgba(255, 255, 255, 0.25);
        transform: translateX(5px);
      }

      .layer-item.dragging {
        opacity: 0.5;
        transform: rotate(2deg);
      }

      .layer-item.drag-over {
        border-top: 3px solid white;
      }

      .drag-handle {
        font-size: 1.2rem;
        cursor: grab;
        user-select: none;
      }

      .drag-handle:active {
        cursor: grabbing;
      }

      .layer-checkbox {
        width: 18px;
        height: 18px;
        cursor: pointer;
      }

      .layer-name {
        flex: 1;
        font-weight: 500;
        font-size: 0.9rem;
      }

      .layer-color {
        width: 20px;
        height: 20px;
        border-radius: 4px;
        border: 2px solid rgba(255, 255, 255, 0.5);
      }

      svg {
        width: 100%;
        height: 100%;
      }

      .ring-sector {
        stroke: rgba(255, 255, 255, 0.6);
        stroke-width: 1.5;
        cursor: pointer;
        transition: opacity 0.3s ease, stroke-width 0.3s ease;
        pointer-events: all;
      }

      .ring-sector:hover {
        opacity: 0.9;
        stroke: white;
        stroke-width: 3;
      }

      .ring-separator {
        fill: none;
        stroke: rgba(0, 0, 0, 0.25);
        stroke-width: 3;
        pointer-events: none;
      }

      .ring-label {
        fill: rgba(0, 0, 0, 0.9);
        font-size: 13px;
        font-weight: 700;
        pointer-events: none;
        user-select: none;
        paint-order: stroke fill;
        stroke: rgba(255, 255, 255, 0.8);
        stroke-width: 3px;
        stroke-linecap: round;
        stroke-linejoin: round;
      }

      .center-text {
        fill: rgba(0, 0, 0, 0.7);
        font-size: 32px;
        font-weight: 700;
        text-anchor: middle;
        dominant-baseline: middle;
        pointer-events: none;
      }

      /* Mobile optimizations */
      @media (max-width: 768px) {
        /* Prevent horizontal scrolling */
        html,
        body {
          overflow-x: hidden;
          max-width: 100vw;
        }

        body {
          padding: 5px;
        }

        /* Split header into multiple lines on mobile */
        header > div {
          flex-direction: column;
          align-items: flex-start !important;
          gap: 12px !important;
        }

        header > div > div:first-child {
          flex-wrap: wrap;
          width: 100%;
          gap: 8px !important;
        }

        header > div > div:last-child {
          width: 100%;
          justify-content: flex-start;
        }

        /* Logo on first line */
        header h1 {
          width: 100%;
          margin-bottom: 8px;
        }

        /* Mode selector on second line */
        header [role="radiogroup"] {
          width: 100%;
          margin-bottom: 8px;
        }

        /* Settings buttons on third line */
        header button[id^="toggle"] {
          margin-right: 8px;
        }

        h1 {
          font-size: 1.5rem;
          margin-bottom: 8px;
        }

        .subtitle {
          font-size: 0.8rem;
          margin-bottom: 15px;
        }

        .controls {
          padding: 15px;
          width: 100%;
          max-width: 100%;
          margin-bottom: 15px;
        }

        .control-group {
          margin-bottom: 12px;
        }

        label {
          font-size: 0.85rem;
        }

        .value-display {
          font-size: 0.8rem;
          padding: 2px 8px;
        }

        .main-content {
          flex-direction: column;
          align-items: center;
          gap: 15px;
          width: 100%;
        }

        #canvas-container {
          width: min(95vw, calc(95vh - 200px));
          height: min(95vw, calc(95vh - 200px));
          max-width: none;
          max-height: none;
          min-width: 0;
        }

        .layer-controls {
          width: 90%;
          max-width: 100%;
          min-width: auto;
        }

        .layer-controls h3 {
          font-size: 1rem;
        }

        .layer-item {
          padding: 10px;
          font-size: 0.85rem;
        }

        .ring-label {
          font-size: 11px;
          stroke-width: 2.5px;
        }

        .center-text {
          font-size: 24px;
        }

        button {
          font-size: 0.85rem !important;
        }
      }

      @media (max-width: 480px) {
        h1 {
          font-size: 1.3rem;
        }

        .subtitle {
          font-size: 0.75rem;
        }

        .controls {
          padding: 12px;
        }

        label {
          font-size: 0.8rem;
          margin-bottom: 6px;
        }

        .layer-controls {
          width: 95%;
        }

        .layer-item {
          padding: 8px;
          gap: 8px;
        }

        .layer-name {
          font-size: 0.8rem;
        }

        .drag-handle {
          font-size: 1rem;
        }

        .ring-label {
          font-size: 10px;
          stroke-width: 2px;
        }

        .center-text {
          font-size: 20px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header with Mode Selector - matches index.html -->
    <header
      class="w-full max-w-7xl mx-auto px-4 sm:px-6 py-4 sm:py-6"
      style="overflow-x: hidden"
    >
      <div
        class="flex flex-col sm:flex-row items-start sm:items-center justify-between flex-wrap gap-3 sm:gap-4"
      >
        <div
          class="flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3 w-full sm:w-auto"
        >
          <h1
            class="text-2xl font-bold bg-gradient-to-r from-primary-400 to-primary-600 bg-clip-text text-transparent"
          >
            YearWheel
          </h1>
          <!-- Mode Selector (Radio Buttons) -->
          <div
            class="flex items-center gap-3"
            role="radiogroup"
            aria-label="Select calendar mode"
          >
            <label class="flex items-center gap-1.5 cursor-pointer group">
              <input
                type="radio"
                name="headerMode"
                value="old"
                id="headerModeOld"
                class="w-3.5 h-3.5 border-gray-600 text-primary-500 focus:ring-primary-500 cursor-pointer"
              />
              <span
                class="text-xs text-dark-muted group-hover:text-gray-300 transition-colors"
                >Classic</span
              >
            </label>
            <label class="flex items-center gap-1.5 cursor-pointer group">
              <input
                type="radio"
                name="headerMode"
                value="rings"
                id="headerModeRings"
                class="w-3.5 h-3.5 border-gray-600 text-primary-500 focus:ring-primary-500 cursor-pointer"
                checked
              />
              <span
                class="text-xs text-dark-muted group-hover:text-gray-300 transition-colors"
                >Rings</span
              >
            </label>
            <label class="flex items-center gap-1.5 cursor-pointer group">
              <input
                type="radio"
                name="headerMode"
                value="zoom"
                id="headerModeZoom"
                class="w-3.5 h-3.5 border-gray-600 text-primary-500 focus:ring-primary-500 cursor-pointer"
              />
              <span
                class="text-xs text-dark-muted group-hover:text-gray-300 transition-colors"
                >Zoom</span
              >
            </label>
          </div>
          <button
            id="toggleSettingsRings"
            class="btn text-xs"
            aria-label="Toggle settings panel"
            title="Settings & Controls"
          >
            ‚öôÔ∏è
          </button>
          <button
            id="toggleAboutRings"
            class="btn text-xs"
            aria-label="Toggle about panel"
            title="About"
          >
            ‚ÑπÔ∏è
          </button>
        </div>

        <!-- Login Status / Sign In Button -->
        <div id="headerAuthRings" class="flex items-center gap-2">
          <!-- Logged In Status (shown when authenticated) -->
          <div
            id="loginStatusRings"
            class="flex items-center gap-2 glass px-3 py-1.5 rounded-lg border border-dark-border text-sm hidden"
          >
            <span class="status-dot w-2 h-2 rounded-full bg-green-500"></span>
            <span class="status-text">Logged in</span>
          </div>

          <!-- Sign In Button (shown when NOT authenticated) -->
          <button
            id="headerSignInBtnRings"
            class="btn primary flex items-center gap-2 text-sm hidden"
            aria-label="Sign in with Google Calendar"
          >
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
              />
              <path
                d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
              />
              <path
                d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
              />
              <path
                d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
              />
            </svg>
            <span>Sign in with Google</span>
          </button>
        </div>
      </div>
    </header>

    <h1 style="margin-top: 0; margin-bottom: 10px">üéØ Multi-Ring Calendar</h1>
    <p class="subtitle">
      Perimeter-preserving morphing shape with 5 calendar rings + drag-and-drop
      reordering
    </p>

    <!-- Layer Controls at top (hideable) -->
    <div class="layer-controls" id="layerControls" style="margin-bottom: 20px">
      <div
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 10px;
        "
      >
        <h3 style="margin: 0">üìö Layer Controls</h3>
        <button
          id="toggleLayerControls"
          style="
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.2s;
          "
          title="Toggle Layer Controls"
        >
          <span id="layerControlsToggleText">‚ñ∂ Show</span>
        </button>
      </div>
      <div id="layerControlsContent" style="display: none">
        <p style="font-size: 0.85rem; opacity: 0.8; margin-bottom: 15px">
          Drag to reorder ‚Ä¢ Click checkbox to show/hide
        </p>
        <ul class="layer-list" id="layerList">
          <!-- Populated by JavaScript -->
        </ul>
      </div>
    </div>

    <div class="main-content">
      <div id="canvas-container">
        <svg id="calendar-svg" viewBox="0 0 700 700">
          <defs>
            <!-- Gradients for each ring -->
            <linearGradient
              id="gradient-seasons"
              x1="0%"
              y1="0%"
              x2="100%"
              y2="100%"
            >
              <stop offset="0%" style="stop-color: #667eea; stop-opacity: 1" />
              <stop
                offset="100%"
                style="stop-color: #764ba2; stop-opacity: 1"
              />
            </linearGradient>
            <linearGradient
              id="gradient-months"
              x1="0%"
              y1="0%"
              x2="100%"
              y2="100%"
            >
              <stop offset="0%" style="stop-color: #f093fb; stop-opacity: 1" />
              <stop
                offset="100%"
                style="stop-color: #f5576c; stop-opacity: 1"
              />
            </linearGradient>
            <linearGradient
              id="gradient-hebrew"
              x1="0%"
              y1="0%"
              x2="100%"
              y2="100%"
            >
              <stop offset="0%" style="stop-color: #4facfe; stop-opacity: 1" />
              <stop
                offset="100%"
                style="stop-color: #00f2fe; stop-opacity: 1"
              />
            </linearGradient>
            <linearGradient
              id="gradient-weeks"
              x1="0%"
              y1="0%"
              x2="100%"
              y2="100%"
            >
              <stop offset="0%" style="stop-color: #43e97b; stop-opacity: 1" />
              <stop
                offset="100%"
                style="stop-color: #38f9d7; stop-opacity: 1"
              />
            </linearGradient>
            <linearGradient
              id="gradient-holidays"
              x1="0%"
              y1="0%"
              x2="100%"
              y2="100%"
            >
              <stop offset="0%" style="stop-color: #ffeaa7; stop-opacity: 1" />
              <stop
                offset="100%"
                style="stop-color: #fdcb6e; stop-opacity: 1"
              />
            </linearGradient>
          </defs>

          <!-- Ring groups (rendered by JavaScript) -->
          <g id="rings-container"></g>

          <!-- Today indicator line -->
          <line
            id="todayLine"
            x1="350"
            y1="350"
            x2="350"
            y2="100"
            stroke="#ff4444"
            stroke-width="3"
            stroke-dasharray="5,5"
            opacity="0.8"
            pointer-events="none"
          >
            <animate
              attributeName="opacity"
              values="0.8;1;0.8"
              dur="2s"
              repeatCount="indefinite"
            />
          </line>

          <!-- Today indicator dot at the end of line -->
          <circle
            id="todayDot"
            cx="350"
            cy="100"
            r="6"
            fill="#ff4444"
            stroke="white"
            stroke-width="2"
            pointer-events="none"
          >
            <animate
              attributeName="r"
              values="6;8;6"
              dur="2s"
              repeatCount="indefinite"
            />
          </circle>

          <!-- Center text (will be counter-mirrored by JavaScript in CCW mode) -->
          <text
            class="center-text"
            id="centerText"
            x="350"
            y="350"
            transform-origin="350 350"
          >
            2025
          </text>
        </svg>
      </div>
    </div>

    <!-- Controls at bottom -->
    <div class="controls" style="margin-top: 20px; margin-bottom: 0">
      <div class="control-group">
        <label>
          Shape (Square ‚Üî Circle)
          <span class="value-display" id="cornerValue">50%</span>
        </label>
        <input type="range" id="cornerRadius" min="0" max="100" value="50" />
      </div>

      <div class="control-group">
        <label>
          Ring Width
          <span class="value-display" id="widthValue">50px</span>
        </label>
        <input type="range" id="ringWidth" min="30" max="80" value="50" />
      </div>

      <div class="control-group">
        <label>Direction & Rotation</label>
        <div style="display: flex; gap: 10px; margin-top: 8px">
          <button
            id="directionToggle"
            style="
              flex: 1;
              padding: 8px;
              background: rgba(255, 255, 255, 0.2);
              border: 1px solid rgba(255, 255, 255, 0.3);
              border-radius: 6px;
              color: white;
              cursor: pointer;
              font-weight: 600;
              transition: all 0.2s;
            "
          >
            ‚Üª CW
          </button>
          <button
            id="rotateYear"
            style="
              flex: 1;
              padding: 8px;
              background: rgba(255, 255, 255, 0.2);
              border: 1px solid rgba(255, 255, 255, 0.3);
              border-radius: 6px;
              color: white;
              cursor: pointer;
              font-weight: 600;
              transition: all 0.2s;
            "
          >
            üîÑ Rotate 90¬∞
          </button>
        </div>
      </div>
    </div>

    <!-- OLD INLINE SCRIPT - MOVED TO TypeScript MODULES
    All JavaScript has been extracted to:
    - src/calendar/rings/constants.ts (constants)
    - src/calendar/rings/Ring.ts (base class)
    - src/calendar/rings/ringImplementations.ts (ring implementations)
    - src/calendar/rings/RingSystem.ts (ring system manager)
    - src/calendar/RingsMode.ts (main mode class)
    - src/rings.ts (entry point)
    -->
    <!-- Script block removed - all code moved to TypeScript modules -->
    <!-- All JavaScript code has been moved to TypeScript modules (src/rings.ts and related files) -->

    <!-- Use TypeScript module for rings mode -->
    <script type="module" src="/rings.ts"></script>

    <!-- Footer -->
    <footer
      class="w-full max-w-7xl mx-auto px-6 py-4 mt-auto border-t border-dark-border"
      style="border-top: 1px solid rgba(255, 255, 255, 0.1); margin-top: auto"
    >
      <div
        class="flex flex-col sm:flex-row items-center justify-between gap-4 text-sm"
        style="color: rgba(255, 255, 255, 0.7)"
      >
        <div
          class="flex items-center gap-4 flex-wrap justify-center sm:justify-start"
        >
          <span>YearWheel v0.11.0</span>
          <span>‚Ä¢</span>
          <a
            href="privacy.html"
            style="color: rgba(255, 255, 255, 0.7); transition: color 0.2s"
            onmouseover="this.style.color='rgba(255, 255, 255, 0.9)'"
            onmouseout="this.style.color='rgba(255, 255, 255, 0.7)'"
            >Privacy Policy</a
          >
          <span>‚Ä¢</span>
          <a
            href="terms.html"
            style="color: rgba(255, 255, 255, 0.7); transition: color 0.2s"
            onmouseover="this.style.color='rgba(255, 255, 255, 0.9)'"
            onmouseout="this.style.color='rgba(255, 255, 255, 0.7)'"
            >Terms of Service</a
          >
          <span>‚Ä¢</span>
          <a
            href="agreement.html"
            style="color: rgba(255, 255, 255, 0.7); transition: color 0.2s"
            onmouseover="this.style.color='rgba(255, 255, 255, 0.9)'"
            onmouseout="this.style.color='rgba(255, 255, 255, 0.7)'"
            >User Agreement</a
          >
        </div>
        <div style="font-size: 0.75rem; color: rgba(255, 255, 255, 0.6)">
          ¬© 2025 YearWheel. All rights reserved.
        </div>
      </div>
    </footer>
  </body>
</html>
